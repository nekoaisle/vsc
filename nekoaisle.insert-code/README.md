# insert-code README

現在の状態またはユーザー作成のテンプレートをカーソル位置に挿入します。  

## 特徴

任意のディレクトリに拡張仕事のメニュー及びテンプレートを格納します。

### 拡張子ごとのメニュー

拡張子ごとにメニューを作成し、メニューにコマンドまたはテンプレート名および挿入位置を記述します。

メニューは１行に１メニューを書いたtsv(タブ区切りファイル)です。  
* ファイル名は list-[拡張子名].tsv  
* １列目：メニュー名
* ２列目：テンプレートファイル名、コマンド名、インラインテンプレート
* ３列目：挿入位置

２列目
* @ で始まる場合はコマンド名
* # で始まる場合はインラインテンプレート
* その他はテンプレートファイル名

|列番号  |１列目             |２列目                            |３列目  |
|--------|-------------------|----------------------------------|--------|
|列の意味|メニュー名         |ファイル名,コマンド名,テンプレート|挿入位置|
|例      |1: ファイルヘッダー|fileheader.php                    |top     |
|例      |Y: 今日            |@now.ymd                          |        |
|例      |": ""括り          |#"{{selection}}"                  |        |

### コマンド

|コマンド   |機能             |
|-----------|-----------------|
|@now.ymd   |日付             |
|@pinfo.path|フルパス名       |
|@pinfo.dir |ディレクトリ名   |
|@pinfo.base|ファイル名+拡張子|
|@pinfo.name|ファイル名       |
|@pinfo.ext |拡張子           |

### 挿入位置

|挿入位置      |キーワード                   |
|--------------|-----------------------------|
|ファイルの先頭|top, file-start, file-top    |
|ファイルの末尾|bottom, file-end, file-bottom|
|行頭          |home, line-start, line-top   |
|行末          |end, line-end, line-bottom   |
|次の行        |new, line-new, new-line      |

### テンプレート

テンプレートを挿入する場合テンプレート内の特定のキーワードを動的に置換します。

|コマンド|置換内容|
|--------------|-----------------|  
|{{author}}    |著者             |
|{{pinfo.path}}|フルパス名       |
|{{pinfo.dir}} |ディレクトリ名   |
|{{pinfo.base}}|ファイル名+拡張子|
|{{pinfo.name}}|ファイル名       |
|{{pinfo.ext}} |拡張子           |
|{{now.year}}  |年               |
|{{now.month}} |月               |
|{{now.date}}  |日               |
|{{now.hour}}  |時               |
|{{now.min}}   |分               |
|{{now.sec}}   |秒               |
|{{selection}} |選択範囲         |
|{{clipboard}} |クリップボード   |

また、上記のキーワードを '' または "" で括ると置換する文字列中の \ や ' をクオートします。

## 設定

* `insertCode.author`: 著者名
* `insertCode.tempDir`: メニュー及びテンプレート格納ディレクトリ

For example:

* `insertCode.author`: "木屋善夫"
* `insertCode.tempDir`: "~/Documents/vsc/insertCode"
